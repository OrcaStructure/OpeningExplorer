(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[427],{27889:function(e,t,r){var n,o=function(e){var t="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",r=["1-0","0-1","1/2-1/2","*"],n={b:[16,32,17,15],w:[-16,-32,-17,-15]},o={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},i=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],l=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],a={p:0,n:1,b:2,r:3,q:4,k:5},s={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"},c={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},u={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},p={w:[{square:u.a1,flag:c.QSIDE_CASTLE},{square:u.h1,flag:c.KSIDE_CASTLE}],b:[{square:u.a8,flag:c.QSIDE_CASTLE},{square:u.h8,flag:c.KSIDE_CASTLE}]},d=Array(128),f={w:-1,b:-1},h="w",g={w:0,b:0},v=-1,b=0,m=1,y=[],w={},P={};function k(e){void 0===e&&(e=!1),d=Array(128),f={w:-1,b:-1},h="w",g={w:0,b:0},v=-1,b=0,m=1,y=[],e||(w={}),P={},O(S())}function C(){for(var e=[],t={},r=function(e){(e in P)&&(t[e]=P[e])};y.length>0;)e.push(Q());for(r(S());e.length>0;)B(e.pop()),r(S());P=t}function _(e,t){void 0===t&&(t=!1);var r=e.split(/\s+/),n=r[0],o=0;if(!E(e).valid)return!1;k(t);for(var i=0;i<n.length;i++){var l=n.charAt(i);if("/"===l)o+=8;else if(-1!=="0123456789".indexOf(l))o+=parseInt(l,10);else{var a=l<"a"?"w":"b";M({type:l.toLowerCase(),color:a},$(o)),o++}}return h=r[1],r[2].indexOf("K")>-1&&(g.w|=c.KSIDE_CASTLE),r[2].indexOf("Q")>-1&&(g.w|=c.QSIDE_CASTLE),r[2].indexOf("k")>-1&&(g.b|=c.KSIDE_CASTLE),r[2].indexOf("q")>-1&&(g.b|=c.QSIDE_CASTLE),v="-"===r[3]?-1:u[r[3]],b=parseInt(r[4],10),m=parseInt(r[5],10),O(S()),!0}function E(e){var t={0:"No errors.",1:"FEN string must contain six space-delimited fields.",2:"6th field (move number) must be a positive integer.",3:"5th field (half move counter) must be a non-negative integer.",4:"4th field (en-passant square) is invalid.",5:"3rd field (castling availability) is invalid.",6:"2nd field (side to move) is invalid.",7:"1st field (piece positions) does not contain 8 '/'-delimited rows.",8:"1st field (piece positions) is invalid [consecutive numbers].",9:"1st field (piece positions) is invalid [invalid piece].",10:"1st field (piece positions) is invalid [row too large].",11:"Illegal en-passant square"},r=e.split(/\s+/);if(6!==r.length)return{valid:!1,error_number:1,error:t[1]};if(isNaN(r[5])||0>=parseInt(r[5],10))return{valid:!1,error_number:2,error:t[2]};if(isNaN(r[4])||0>parseInt(r[4],10))return{valid:!1,error_number:3,error:t[3]};if(!/^(-|[abcdefgh][36])$/.test(r[3]))return{valid:!1,error_number:4,error:t[4]};if(!/^(KQ?k?q?|Qk?q?|kq?|q|-)$/.test(r[2]))return{valid:!1,error_number:5,error:t[5]};if(!/^(w|b)$/.test(r[1]))return{valid:!1,error_number:6,error:t[6]};var n=r[0].split("/");if(8!==n.length)return{valid:!1,error_number:7,error:t[7]};for(var o=0;o<n.length;o++){for(var i=0,l=!1,a=0;a<n[o].length;a++)if(isNaN(n[o][a])){if(!/^[prnbqkPRNBQK]$/.test(n[o][a]))return{valid:!1,error_number:9,error:t[9]};i+=1,l=!1}else{if(l)return{valid:!1,error_number:8,error:t[8]};i+=parseInt(n[o][a],10),l=!0}if(8!==i)return{valid:!1,error_number:10,error:t[10]}}return"3"==r[3][1]&&"w"==r[1]||"6"==r[3][1]&&"b"==r[1]?{valid:!1,error_number:11,error:t[11]}:{valid:!0,error_number:0,error:t[0]}}function S(){for(var e=0,t="",r=u.a8;r<=u.h1;r++){if(null==d[r])e++;else{e>0&&(t+=e,e=0);var n=d[r].color,o=d[r].type;t+="w"===n?o.toUpperCase():o.toLowerCase()}r+1&136&&(e>0&&(t+=e),r!==u.h1&&(t+="/"),e=0,r+=8)}var i="";g.w&c.KSIDE_CASTLE&&(i+="K"),g.w&c.QSIDE_CASTLE&&(i+="Q"),g.b&c.KSIDE_CASTLE&&(i+="k"),g.b&c.QSIDE_CASTLE&&(i+="q"),i=i||"-";var l=-1===v?"-":$(v);return[t,h,i,l,b,m].join(" ")}function A(e){for(var t=0;t<e.length;t+=2)"string"==typeof e[t]&&"string"==typeof e[t+1]&&(w[e[t]]=e[t+1]);return w}function O(e){y.length>0||(e!==t?(w.SetUp="1",w.FEN=e):(delete w.SetUp,delete w.FEN))}function T(e){var t=d[u[e]];return t?{type:t.type,color:t.color}:null}function M(e,t){if(!("type"in e&&"color"in e)||-1==="pnbrqkPNBRQK".indexOf(e.type.toLowerCase())||!(t in u))return!1;var r=u[t];return("k"!=e.type||-1==f[e.color]||f[e.color]==r)&&(d[r]={type:e.type,color:e.color},"k"===e.type&&(f[e.color]=r),O(S()),!0)}function R(e,t,r,n,o){var i={color:h,from:t,to:r,flags:n,piece:e[t].type};return o&&(i.flags|=c.PROMOTION,i.promotion=o),e[r]?i.captured=e[r].type:n&c.EP_CAPTURE&&(i.captured="p"),i}function L(e){function t(e,t,r,n,o){if("p"===e[r].type&&(0==n>>4||7==n>>4))for(var i=["q","r","b","n"],l=0,a=i.length;l<a;l++)t.push(R(e,r,n,o,i[l]));else t.push(R(e,r,n,o))}var r=[],i=h,l=F(i),a={b:1,w:6},s=u.a8,p=u.h1,b=!1,m=void 0===e||!("legal"in e)||e.legal,y=void 0===e||!("piece"in e)||"string"!=typeof e.piece||e.piece.toLowerCase();if(void 0!==e&&"square"in e){if(!(e.square in u))return[];s=p=u[e.square],b=!0}for(var w=s;w<=p;w++){if(136&w){w+=7;continue}var P=d[w];if(null!=P&&P.color===i){if("p"===P.type&&(!0===y||"p"===y)){var k=w+n[i][0];if(null==d[k]){t(d,r,w,k,c.NORMAL);var k=w+n[i][1];a[i]===w>>4&&null==d[k]&&t(d,r,w,k,c.BIG_PAWN)}for(C=2;C<4;C++){var k=w+n[i][C];136&k||(null!=d[k]&&d[k].color===l?t(d,r,w,k,c.CAPTURE):k===v&&t(d,r,w,v,c.EP_CAPTURE))}}else if(!0===y||y===P.type)for(var C=0,_=o[P.type].length;C<_;C++)for(var E=o[P.type][C],k=w;!(136&(k+=E));){if(null==d[k])t(d,r,w,k,c.NORMAL);else{if(d[k].color===i)break;t(d,r,w,k,c.CAPTURE);break}if("n"===P.type||"k"===P.type)break}}}if((!0===y||"k"===y)&&(!b||p===f[i])){if(g[i]&c.KSIDE_CASTLE){var S=f[i],A=S+2;null!=d[S+1]||null!=d[A]||N(l,f[i])||N(l,S+1)||N(l,A)||t(d,r,f[i],A,c.KSIDE_CASTLE)}if(g[i]&c.QSIDE_CASTLE){var S=f[i],A=S-2;null!=d[S-1]||null!=d[S-2]||null!=d[S-3]||N(l,f[i])||N(l,S-1)||N(l,A)||t(d,r,f[i],A,c.QSIDE_CASTLE)}}if(!m)return r;for(var O=[],w=0,_=r.length;w<_;w++)B(r[w]),D(i)||O.push(r[w]),Q();return O}function I(e,t){var r="";if(e.flags&c.KSIDE_CASTLE)r="O-O";else if(e.flags&c.QSIDE_CASTLE)r="O-O-O";else{if("p"!==e.piece){var n=function(e,t){for(var r=e.from,n=e.to,o=e.piece,i=0,l=0,a=0,s=0,c=t.length;s<c;s++){var u=t[s].from,p=t[s].to;o===t[s].piece&&r!==u&&n===p&&(i++,r>>4==u>>4&&l++,(15&r)==(15&u)&&a++)}return i>0?l>0&&a>0?$(r):a>0?$(r).charAt(1):$(r).charAt(0):""}(e,t);r+=e.piece.toUpperCase()+n}e.flags&(c.CAPTURE|c.EP_CAPTURE)&&("p"===e.piece&&(r+=$(e.from)[0]),r+="x"),r+=$(e.to),e.flags&c.PROMOTION&&(r+="="+e.promotion.toUpperCase())}return B(e),D(h)&&(x()?r+="#":r+="+"),Q(),r}function K(e){return e.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}function N(e,t){for(var r=u.a8;r<=u.h1;r++){if(136&r){r+=7;continue}if(null!=d[r]&&d[r].color===e){var n=d[r],o=r-t,s=o+119;if(i[s]&1<<a[n.type]){if("p"===n.type){if(o>0){if("w"===n.color)return!0}else if("b"===n.color)return!0;continue}if("n"===n.type||"k"===n.type)return!0;for(var c=l[s],p=r+c,f=!1;p!==t;){if(null!=d[p]){f=!0;break}p+=c}if(!f)return!0}}}return!1}function D(e){return N(F(e),f[e])}function x(){return D(h)&&0===L().length}function j(){return!D(h)&&0===L().length}function q(){for(var e={},t=[],r=0,n=0,o=u.a8;o<=u.h1;o++){if(n=(n+1)%2,136&o){o+=7;continue}var i=d[o];i&&(e[i.type]=i.type in e?e[i.type]+1:1,"b"===i.type&&t.push(n),r++)}if(2===r||3===r&&(1===e.b||1===e.n))return!0;if(r===e.b+2){for(var l=0,a=t.length,o=0;o<a;o++)l+=t[o];if(0===l||l===a)return!0}return!1}function U(){for(var e=[],t={},r=!1;;){var n=Q();if(!n)break;e.push(n)}for(;;){var o=S().split(" ").slice(0,4).join(" ");if(t[o]=o in t?t[o]+1:1,t[o]>=3&&(r=!0),!e.length)break;B(e.pop())}return r}function B(e){var t=h,r=F(t);if(y.push({move:e,kings:{b:f.b,w:f.w},turn:h,castling:{b:g.b,w:g.w},ep_square:v,half_moves:b,move_number:m}),d[e.to]=d[e.from],d[e.from]=null,e.flags&c.EP_CAPTURE&&("b"===h?d[e.to-16]=null:d[e.to+16]=null),e.flags&c.PROMOTION&&(d[e.to]={type:e.promotion,color:t}),"k"===d[e.to].type){if(f[d[e.to].color]=e.to,e.flags&c.KSIDE_CASTLE){var n=e.to-1,o=e.to+1;d[n]=d[o],d[o]=null}else if(e.flags&c.QSIDE_CASTLE){var n=e.to+1,o=e.to-2;d[n]=d[o],d[o]=null}g[t]=""}if(g[t]){for(var i=0,l=p[t].length;i<l;i++)if(e.from===p[t][i].square&&g[t]&p[t][i].flag){g[t]^=p[t][i].flag;break}}if(g[r]){for(var i=0,l=p[r].length;i<l;i++)if(e.to===p[r][i].square&&g[r]&p[r][i].flag){g[r]^=p[r][i].flag;break}}v=e.flags&c.BIG_PAWN?"b"===h?e.to-16:e.to+16:-1,"p"===e.piece?b=0:e.flags&(c.CAPTURE|c.EP_CAPTURE)?b=0:b++,"b"===h&&m++,h=F(h)}function Q(){var e,t,r=y.pop();if(null==r)return null;var n=r.move;f=r.kings,h=r.turn,g=r.castling,v=r.ep_square,b=r.half_moves,m=r.move_number;var o=h,i=F(h);return d[n.from]=d[n.to],d[n.from].type=n.piece,d[n.to]=null,n.flags&c.CAPTURE?d[n.to]={type:n.captured,color:i}:n.flags&c.EP_CAPTURE&&(d["b"===o?n.to-16:n.to+16]={type:"p",color:i}),n.flags&(c.KSIDE_CASTLE|c.QSIDE_CASTLE)&&(n.flags&c.KSIDE_CASTLE?(e=n.to+1,t=n.to-1):n.flags&c.QSIDE_CASTLE&&(e=n.to-2,t=n.to+1),d[e]=d[t],d[t]=null),n}function W(e,t){var r=K(e);if(t){var n=r.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/);if(n)var o=n[1],i=n[2],l=n[3],a=n[4]}var s=function(e){var t=e.charAt(0);if(t>="a"&&t<="h"){if(e.match(/[a-h]\d.*[a-h]\d/))return;return"p"}return"o"===(t=t.toLowerCase())?"k":t}(r),c=null,p=L({legal:!0,piece:o||s});if(c=p,t){var d=L({legal:!1,piece:o||s});c=d}for(var f=0,h=c.length;f<h;f++)if(r===K(I(c[f],p))||t&&r===K(I(c[f],d))||n&&(!o||o.toLowerCase()==c[f].piece)&&u[i]==c[f].from&&u[l]==c[f].to&&(!a||a.toLowerCase()==c[f].promotion))return c[f];return null}function $(e){var t=15&e,r=e>>4;return"abcdefgh".substring(t,t+1)+"87654321".substring(r,r+1)}function F(e){return"w"===e?"b":"w"}function z(e){var t=function e(t){var r=t instanceof Array?[]:{};for(var n in t)"object"==typeof n?r[n]=e(t[n]):r[n]=t[n];return r}(e);t.san=I(t,L({legal:!0})),t.to=$(t.to),t.from=$(t.from);var r="";for(var n in c)c[n]&t.flags&&(r+=s[n]);return t.flags=r,t}function H(e){return e.replace(/^\s+|\s+$/g,"")}return void 0===e?_(t):_(e),{WHITE:"w",BLACK:"b",PAWN:"p",KNIGHT:"n",BISHOP:"b",ROOK:"r",QUEEN:"q",KING:"k",SQUARES:function(){for(var e=[],t=u.a8;t<=u.h1;t++){if(136&t){t+=7;continue}e.push($(t))}return e}(),FLAGS:s,load:function(e){return _(e)},reset:function(){_(t)},moves:function(e){for(var t=L(e),r=[],n=0,o=t.length;n<o;n++)void 0!==e&&"verbose"in e&&e.verbose?r.push(z(t[n])):r.push(I(t[n],L({legal:!0})));return r},in_check:function(){return D(h)},in_checkmate:function(){return x()},in_stalemate:function(){return j()},in_draw:function(){return b>=100||j()||q()||U()},insufficient_material:function(){return q()},in_threefold_repetition:function(){return U()},game_over:function(){return b>=100||x()||j()||q()||U()},validate_fen:function(e){return E(e)},fen:function(){return S()},board:function(){for(var e=[],t=[],r=u.a8;r<=u.h1;r++)null==d[r]?t.push(null):t.push({type:d[r].type,color:d[r].color}),r+1&136&&(e.push(t),t=[],r+=8);return e},pgn:function(e){var t="object"==typeof e&&"string"==typeof e.newline_char?e.newline_char:"\n",r="object"==typeof e&&"number"==typeof e.max_width?e.max_width:0,n=[],o=!1;for(var i in w)n.push("["+i+' "'+w[i]+'"]'+t),o=!0;o&&y.length&&n.push(t);for(var l=function(e){var t=P[S()];if(void 0!==t){var r=e.length>0?" ":"";e=`${e}${r}{${t}}`}return e},a=[];y.length>0;)a.push(Q());var s=[],c="";for(0===a.length&&s.push(l(""));a.length>0;){c=l(c);var u=a.pop();y.length||"b"!==u.color?"w"===u.color&&(c.length&&s.push(c),c=m+"."):c=m+". ...",c=c+" "+I(u,L({legal:!1})),B(u)}if(c.length&&s.push(l(c)),void 0!==w.Result&&s.push(w.Result),0===r)return n.join("")+s.join(" ");for(var p=function(){return n.length>0&&" "===n[n.length-1]&&(n.pop(),!0)},d=0,i=0;i<s.length;i++){if(d+s[i].length>r&&s[i].includes("{")){d=function(e,o){for(var i of o.split(" "))if(i){if(e+i.length>r){for(;p();)e--;n.push(t),e=0}n.push(i),e+=i.length,n.push(" "),e++}return p()&&e--,e}(d,s[i]);continue}d+s[i].length>r&&0!==i?(" "===n[n.length-1]&&n.pop(),n.push(t),d=0):0!==i&&(n.push(" "),d++),n.push(s[i]),d+=s[i].length}return n.join("")},load_pgn:function(e,n){var o=void 0!==n&&"sloppy"in n&&n.sloppy;function i(e){return e.replace(/\\/g,"\\")}var l="object"==typeof n&&"string"==typeof n.newline_char?n.newline_char:"\r?\n",a=RegExp("^(\\[((?:"+i(l)+")|.)*\\])(?:"+i(l)+"){2}"),s=a.test(e)?a.exec(e)[1]:"";_(t);var c=function(e,t){for(var r="object"==typeof t&&"string"==typeof t.newline_char?t.newline_char:"\r?\n",n={},o=e.split(new RegExp(i(r))),l="",a="",s=0;s<o.length;s++)l=o[s].replace(/^\[([A-Z][A-Za-z]*)\s.*\]$/,"$1"),a=o[s].replace(/^\[[A-Za-z]+\s"(.*)"\ *\]$/,"$1"),H(l).length>0&&(n[l]=a);return n}(s,n);for(var u in c)A([u,c[u]]);if("1"===c.SetUp&&!("FEN"in c&&_(c.FEN,!0)))return!1;for(var p=function(e){return e=e.replace(RegExp(i(l),"g")," "),`{${Array.from(e.slice(1,e.length-1)).map(function(e){return 128>e.charCodeAt(0)?e.charCodeAt(0).toString(16):encodeURIComponent(e).replace(/\%/g,"").toLowerCase()}).join("")}}`},d=function(e){if(e.startsWith("{")&&e.endsWith("}")){var t;return 0==(t=e.slice(1,e.length-1)).length?"":decodeURIComponent("%"+t.match(/.{1,2}/g).join("%"))}},f=e.replace(s,"").replace(RegExp(`({[^}]*})+?|;([^${i(l)}]*)`,"g"),function(e,t,r){return void 0!==t?p(t):" "+p(`{${r.slice(1)}}`)}).replace(RegExp(i(l),"g")," "),h=/(\([^\(\)]+\))+?/g;h.test(f);)f=f.replace(h,"");var g=H(f=(f=(f=f.replace(/\d+\.(\.\.)?/g,"")).replace(/\.\.\./g,"")).replace(/\$\d+/g,"")).split(new RegExp(/\s+/));g=g.join(",").replace(/,,+/g,",").split(",");for(var v="",b=0;b<g.length-1;b++){var m=d(g[b]);if(void 0!==m){P[S()]=m;continue}if(null==(v=W(g[b],o)))return!1;B(v)}if(void 0!==(m=d(g[g.length-1]))&&(P[S()]=m,g.pop()),v=g[g.length-1],r.indexOf(v)>-1)(function(e){for(var t in e)return!0;return!1})(w)&&void 0===w.Result&&A(["Result",v]);else{if(null==(v=W(v,o)))return!1;B(v)}return!0},header:function(){return A(arguments)},ascii:function(){return function(){for(var e="   +------------------------+\n",t=u.a8;t<=u.h1;t++){if(0==(15&t)&&(e+=" "+"87654321"[t>>4]+" |"),null==d[t])e+=" . ";else{var r=d[t].type;e+=" "+("w"===d[t].color?r.toUpperCase():r.toLowerCase())+" "}t+1&136&&(e+="|\n",t+=8)}return e+"   +------------------------+\n     a  b  c  d  e  f  g  h\n"}()},turn:function(){return h},move:function(e,t){var r=void 0!==t&&"sloppy"in t&&t.sloppy,n=null;if("string"==typeof e)n=W(e,r);else if("object"==typeof e){for(var o=L(),i=0,l=o.length;i<l;i++)if(e.from===$(o[i].from)&&e.to===$(o[i].to)&&(!("promotion"in o[i])||e.promotion===o[i].promotion)){n=o[i];break}}if(!n)return null;var a=z(n);return B(n),a},undo:function(){var e=Q();return e?z(e):null},clear:function(){return k()},put:function(e,t){return M(e,t)},get:function(e){return T(e)},remove:function(e){var t;return t=T(e),d[u[e]]=null,t&&"k"===t.type&&(f[t.color]=-1),O(S()),t},perft:function(e){return function e(t){for(var r=L({legal:!1}),n=0,o=h,i=0,l=r.length;i<l;i++)B(r[i]),!D(o)&&(t-1>0?n+=e(t-1):n++),Q();return n}(e)},square_color:function(e){if(e in u){var t=u[e];return((t>>4)+(15&t))%2==0?"light":"dark"}return null},history:function(e){for(var t=[],r=[],n=void 0!==e&&("verbose"in e)&&e.verbose;y.length>0;)t.push(Q());for(;t.length>0;){var o=t.pop();n?r.push(z(o)):r.push(I(o,L({legal:!0}))),B(o)}return r},get_comment:function(){return P[S()]},set_comment:function(e){P[S()]=e.replace("{","[").replace("}","]")},delete_comment:function(){var e=P[S()];return delete P[S()],e},get_comments:function(){return C(),Object.keys(P).map(function(e){return{fen:e,comment:P[e]}})},delete_comments:function(){return C(),Object.keys(P).map(function(e){var t=P[e];return delete P[e],{fen:e,comment:t}})}}};t.Chess=o,void 0!==(n=(function(){return o}).call(t,r,t,e))&&(e.exports=n)},22042:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(58775);function o(e,t){let r=e(t);return t.dom.redraw(),r}function i(e,t){return{key:e,pos:n.key2pos(e),piece:t}}function l(e){for(let t in e)return!1;return!0}t.anim=function(e,t){return t.animation.enabled?function(e,t){let r=Object.assign({},t.pieces),o=e(t),a=function(e,t){let r,o,l;let a={},s=[],c={},u=[],p=[],d={};for(let t in e)d[t]=i(t,e[t]);for(let e of n.allKeys)r=t.pieces[e],o=d[e],r?o?n.samePiece(r,o.piece)||(u.push(o),p.push(i(e,r))):p.push(i(e,r)):o&&u.push(o);for(let e of p)(o=function(e,t){return t.sort((t,r)=>n.distanceSq(e.pos,t.pos)-n.distanceSq(e.pos,r.pos))[0]}(e,u.filter(t=>n.samePiece(e.piece,t.piece))))&&(l=[o.pos[0]-e.pos[0],o.pos[1]-e.pos[1]],a[e.key]=l.concat(l),s.push(o.key));for(let e of u)n.containsX(s,e.key)||(c[e.key]=e.piece);return{anims:a,fadings:c}}(r,t);if(l(a.anims)&&l(a.fadings))t.dom.redraw();else{let e=t.animation.current&&t.animation.current.start;t.animation.current={start:performance.now(),frequency:1/t.animation.duration,plan:a},e||function e(t,r){let n=t.animation.current;if(void 0===n){t.dom.destroyed||t.dom.redrawNow();return}let o=1-(r-n.start)*n.frequency;if(o<=0)t.animation.current=void 0,t.dom.redrawNow();else{let r=o<.5?4*o*o*o:(o-1)*(2*o-2)*(2*o-2)+1;for(let e in n.plan.anims){let t=n.plan.anims[e];t[2]=t[0]*r,t[3]=t[1]*r}t.dom.redrawNow(!0),requestAnimationFrame((r=performance.now())=>e(t,r))}}(t,performance.now())}return o}(e,t):o(e,t)},t.render=o},57726:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(64272),o=r(87845),i=r(46323),l=r(22042),a=r(11445),s=r(29572);t.start=function(e,t){function r(){n.toggleOrientation(e),t()}return{set(t){t.orientation&&t.orientation!==e.orientation&&r(),(t.fen?l.anim:l.render)(e=>i.configure(e,t),e)},state:e,getFen:()=>o.write(e.pieces),toggleOrientation:r,setPieces(t){l.anim(e=>n.setPieces(e,t),e)},selectSquare(t,r){t?l.anim(e=>n.selectSquare(e,t,r),e):e.selected&&(n.unselect(e),e.dom.redraw())},move(t,r){l.anim(e=>n.baseMove(e,t,r),e)},newPiece(t,r){l.anim(e=>n.baseNewPiece(e,t,r),e)},playPremove(){if(e.premovable.current){if(l.anim(n.playPremove,e))return!0;e.dom.redraw()}return!1},playPredrop(t){if(e.predroppable.current){let r=n.playPredrop(e,t);return e.dom.redraw(),r}return!1},cancelPremove(){l.render(n.unsetPremove,e)},cancelPredrop(){l.render(n.unsetPredrop,e)},cancelMove(){l.render(e=>{n.cancelMove(e),a.cancel(e)},e)},stop(){l.render(e=>{n.stop(e),a.cancel(e)},e)},explode(t){s.default(e,t)},setAutoShapes(t){l.render(e=>e.drawable.autoShapes=t,e)},setShapes(t){l.render(e=>e.drawable.shapes=t,e)},getKeyAtDomPos:t=>n.getKeyAtDomPos(t,n.whitePov(e),e.dom.bounds()),redrawAll:t,dragNewPiece(t,r,n){a.dragNewPiece(e,t,r,n)},destroy(){n.stop(e),e.dom.unbind&&e.dom.unbind(),e.dom.destroyed=!0}}}},64272:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(58775),o=r(76347);function i(e,...t){e&&setTimeout(()=>e(...t),1)}function l(e){e.premovable.current&&(e.premovable.current=void 0,i(e.premovable.events.unset))}function a(e){let t=e.predroppable;t.current&&(t.current=void 0,i(t.events.unset))}function s(e,t,r){let o=e.pieces[t],l=e.pieces[r];if(t===r||!o)return!1;let a=l&&l.color!==o.color?l:void 0;return r===e.selected&&f(e),i(e.events.move,t,r,a),!function(e,t,r){if(!e.autoCastle)return!1;let o=e.pieces[t];if(!o||"king"!==o.role)return!1;let i=n.key2pos(t),l=n.key2pos(r);if(1!==i[1]&&8!==i[1]||i[1]!==l[1])return!1;5===i[0]&&(7===l[0]?r=n.pos2key([8,l[1]]):3===l[0]&&(r=n.pos2key([1,l[1]])));let a=e.pieces[r];return!!a&&a.color===o.color&&"rook"===a.role&&(delete e.pieces[t],delete e.pieces[r],i[0]<l[0]?(e.pieces[n.pos2key([7,l[1]])]=o,e.pieces[n.pos2key([6,l[1]])]=a):(e.pieces[n.pos2key([3,l[1]])]=o,e.pieces[n.pos2key([4,l[1]])]=a),!0)}(e,t,r)&&(e.pieces[r]=o,delete e.pieces[t]),e.lastMove=[t,r],e.check=void 0,i(e.events.change),a||!0}function c(e,t,r,o){if(e.pieces[r]){if(!o)return!1;delete e.pieces[r]}return i(e.events.dropNewPiece,t,r),e.pieces[r]=t,e.lastMove=[r],e.check=void 0,i(e.events.change),e.movable.dests=void 0,e.turnColor=n.opposite(e.turnColor),!0}function u(e,t,r){let o=s(e,t,r);return o&&(e.movable.dests=void 0,e.turnColor=n.opposite(e.turnColor),e.animation.current=void 0),o}function p(e,t,r){if(g(e,t,r)){let n=u(e,t,r);if(n){let o=e.hold.stop();f(e);let l={premove:!1,ctrlKey:e.stats.ctrlKey,holdTime:o};return!0!==n&&(l.captured=n),i(e.movable.events.after,t,r,l),!0}}else{var l;if(t!==r&&v(e,t)&&n.containsX(o.default(e.pieces,t,e.premovable.castle),r))return l={ctrlKey:e.stats.ctrlKey},a(e),e.premovable.current=[t,r],i(e.premovable.events.set,t,r,l),f(e),!0}return f(e),!1}function d(e,t){e.selected=t,v(e,t)?e.premovable.dests=o.default(e.pieces,t,e.premovable.castle):e.premovable.dests=void 0}function f(e){e.selected=void 0,e.premovable.dests=void 0,e.hold.cancel()}function h(e,t){let r=e.pieces[t];return!!r&&("both"===e.movable.color||e.movable.color===r.color&&e.turnColor===r.color)}function g(e,t,r){return t!==r&&h(e,t)&&(e.movable.free||!!e.movable.dests&&n.containsX(e.movable.dests[t],r))}function v(e,t){let r=e.pieces[t];return!!r&&e.premovable.enabled&&e.movable.color===r.color&&e.turnColor!==r.color}function b(e){l(e),a(e),f(e)}t.callUserFunction=i,t.toggleOrientation=function(e){e.orientation=n.opposite(e.orientation),e.animation.current=e.draggable.current=e.selected=void 0},t.reset=function(e){e.lastMove=void 0,f(e),l(e),a(e)},t.setPieces=function(e,t){for(let r in t){let n=t[r];n?e.pieces[r]=n:delete e.pieces[r]}},t.setCheck=function(e,t){if(e.check=void 0,!0===t&&(t=e.turnColor),t)for(let r in e.pieces)"king"===e.pieces[r].role&&e.pieces[r].color===t&&(e.check=r)},t.unsetPremove=l,t.unsetPredrop=a,t.baseMove=s,t.baseNewPiece=c,t.userMove=p,t.dropNewPiece=function(e,t,r,n){if(function(e,t,r){let n=e.pieces[t];return!!n&&r&&(t===r||!e.pieces[r])&&("both"===e.movable.color||e.movable.color===n.color&&e.turnColor===n.color)}(e,t,r)||n){let o=e.pieces[t];delete e.pieces[t],c(e,o,r,n),i(e.movable.events.afterNewPiece,o.role,r,{predrop:!1})}else if(function(e,t,r){let n=e.pieces[t],o=e.pieces[r];return!!n&&r&&(!o||o.color!==e.movable.color)&&e.predroppable.enabled&&("pawn"!==n.role||"1"!==r[1]&&"8"!==r[1])&&e.movable.color===n.color&&e.turnColor!==n.color}(e,t,r)){var o;o=e.pieces[t].role,l(e),e.predroppable.current={role:o,key:r},i(e.predroppable.events.set,o,r)}else l(e),a(e);delete e.pieces[t],f(e)},t.selectSquare=function(e,t,r){if(i(e.events.select,t),e.selected){if(e.selected!==t||e.draggable.enabled){if((e.selectable.enabled||r)&&e.selected!==t&&p(e,e.selected,t)){e.stats.dragged=!1;return}}else{f(e),e.hold.cancel();return}}(h(e,t)||v(e,t))&&(d(e,t),e.hold.start())},t.setSelected=d,t.unselect=f,t.canMove=g,t.isDraggable=function(e,t){let r=e.pieces[t];return!!r&&e.draggable.enabled&&("both"===e.movable.color||e.movable.color===r.color&&(e.turnColor===r.color||e.premovable.enabled))},t.playPremove=function(e){let t=e.premovable.current;if(!t)return!1;let r=t[0],n=t[1],o=!1;if(g(e,r,n)){let t=u(e,r,n);if(t){let l={premove:!0};!0!==t&&(l.captured=t),i(e.movable.events.after,r,n,l),o=!0}}return l(e),o},t.playPredrop=function(e,t){let r=e.predroppable.current,n=!1;if(!r)return!1;if(t(r)){let t={role:r.role,color:e.movable.color};c(e,t,r.key)&&(i(e.movable.events.afterNewPiece,r.role,r.key,{predrop:!0}),n=!0)}return a(e),n},t.cancelMove=b,t.stop=function(e){e.movable.color=e.movable.dests=e.animation.current=void 0,b(e)},t.getKeyAtDomPos=function(e,t,r){let o=Math.ceil((e[0]-r.left)/r.width*8);t||(o=9-o);let i=Math.ceil(8-(e[1]-r.top)/r.height*8);return t||(i=9-i),o>0&&o<9&&i>0&&i<9?n.pos2key([o,i]):void 0},t.whitePov=function(e){return"white"===e.orientation}},27304:function(e,t,r){"use strict";let n=r(57726),o=r(46323),i=r(94177),l=r(43949),a=r(54995),s=r(66697),c=r(53113),u=r(58775);t.H=function(e,t){let r=i.defaults();function p(){let t;let n=r.dom&&r.dom.unbind,o=r.viewOnly&&!r.drawable.visible,i=l.default(e,r,o),p=u.memo(()=>i.board.getBoundingClientRect()),d=e=>{s.render(r),!e&&i.svg&&c.renderSvg(r,i.svg)},f=()=>{p.clear(),s.updateBounds(r),i.svg&&c.renderSvg(r,i.svg)};r.dom={elements:i,bounds:p,redraw:(t=!1,()=>{t||(t=!0,requestAnimationFrame(()=>{d(),t=!1}))}),redrawNow:d,unbind:n,relative:o},r.drawable.prevSvgHash="",d(!1),a.bindBoard(r,f),n||(r.dom.unbind=a.bindDocument(r,f)),r.events.insert&&r.events.insert(i)}return o.configure(r,t||{}),p(),n.start(r,p)}},46323:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(64272),o=r(87845);function i(e){return"object"==typeof e}t.configure=function(e,t){if(t.movable&&t.movable.dests&&(e.movable.dests=void 0),function e(t,r){for(let n in r)i(t[n])&&i(r[n])?e(t[n],r[n]):t[n]=r[n]}(e,t),t.fen&&(e.pieces=o.read(t.fen),e.drawable.shapes=[]),t.hasOwnProperty("check")&&n.setCheck(e,t.check||!1),t.hasOwnProperty("lastMove")&&!t.lastMove?e.lastMove=void 0:t.lastMove&&(e.lastMove=t.lastMove),e.selected&&n.setSelected(e,e.selected),(!e.animation.duration||e.animation.duration<100)&&(e.animation.enabled=!1),!e.movable.rookCastle&&e.movable.dests){let t="white"===e.movable.color?1:8,r="e"+t,n=e.movable.dests[r],o=e.pieces[r];n&&o&&"king"===o.role&&(e.movable.dests[r]=n.filter(e=>!(e==="a"+t&&-1!==n.indexOf("c"+t))&&!(e==="h"+t&&-1!==n.indexOf("g"+t))))}}},11445:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(64272),o=r(58775),i=r(13378),l=r(22042);function a(e,t){let r=n.whitePov(e),i=e.dom.bounds(),l=Math.pow(i.width/8,2);for(let n in e.pieces){let e=p(n,r,i),a=[e.left+e.width/2,e.top+e.height/2];if(o.distanceSq(a,t)<=l)return!0}return!1}function s(e){requestAnimationFrame(()=>{let t=e.draggable.current;if(!t)return;e.animation.current&&e.animation.current.plan.anims[t.orig]&&(e.animation.current=void 0);let r=e.pieces[t.orig];if(r&&o.samePiece(r,t.piece)){if(!t.started&&o.distanceSq(t.epos,t.rel)>=Math.pow(e.draggable.distance,2)&&(t.started=!0),t.started){if("function"==typeof t.element){let e=t.element();if(!e)return;e.cgDragging=!0,e.classList.add("dragging"),t.element=e}t.pos=[t.epos[0]-t.rel[0],t.epos[1]-t.rel[1]];let r=o.posToTranslateAbs(e.dom.bounds())(t.origPos,n.whitePov(e));r[0]+=t.pos[0]+t.dec[0],r[1]+=t.pos[1]+t.dec[1],o.translateAbs(t.element,r)}}else c(e);s(e)})}function c(e){let t=e.draggable.current;t&&(t.newPiece&&delete e.pieces[t.orig],e.draggable.current=void 0,n.unselect(e),u(e),e.dom.redraw())}function u(e){let t=e.dom.elements;t.ghost&&o.setVisible(t.ghost,!1)}function p(e,t,r){let n=o.key2pos(e);return t||(n[0]=9-n[0],n[1]=9-n[1]),{left:r.left+r.width*(n[0]-1)/8,top:r.top+r.height*(8-n[1])/8,width:r.width/8,height:r.height/8}}function d(e,t){let r=e.dom.elements.board.firstChild;for(;r;){if(r.cgKey===t&&"PIECE"===r.tagName)return r;r=r.nextSibling}}t.start=function(e,t){if(void 0!==t.button&&0!==t.button||t.touches&&t.touches.length>1)return;let r=e.dom.bounds(),c=o.eventPosition(t),u=n.getKeyAtDomPos(c,n.whitePov(e),r);if(!u)return;let f=e.pieces[u],h=e.selected;!h&&e.drawable.enabled&&(e.drawable.eraseOnClick||!f||f.color!==e.turnColor)&&i.clear(e),!1!==t.cancelable&&(!t.touches||!e.movable.color||f||h||a(e,c))&&t.preventDefault();let g=!!e.premovable.current,v=!!e.predroppable.current;e.stats.ctrlKey=t.ctrlKey,e.selected&&n.canMove(e,e.selected,u)?l.anim(e=>n.selectSquare(e,u),e):n.selectSquare(e,u);let b=e.selected===u,m=d(e,u);if(f&&m&&b&&n.isDraggable(e,u)){let i=p(u,n.whitePov(e),r);e.draggable.current={orig:u,origPos:o.key2pos(u),piece:f,rel:c,epos:c,pos:[0,0],dec:e.draggable.centerPiece?[c[0]-(i.left+i.width/2),c[1]-(i.top+i.height/2)]:[0,0],started:e.draggable.autoDistance&&e.stats.dragged,element:m,previouslySelected:h,originTarget:t.target},m.cgDragging=!0,m.classList.add("dragging");let l=e.dom.elements.ghost;l&&(l.className=`ghost ${f.color} ${f.role}`,o.translateAbs(l,o.posToTranslateAbs(r)(o.key2pos(u),n.whitePov(e))),o.setVisible(l,!0)),s(e)}else g&&n.unsetPremove(e),v&&n.unsetPredrop(e);e.dom.redraw()},t.pieceCloseTo=a,t.dragNewPiece=function(e,t,r,i){e.pieces.a0=t,e.dom.redraw();let l=o.eventPosition(r),a=n.whitePov(e),c=e.dom.bounds(),u=p("a0",a,c),f=[(a?0:7)*u.width+c.left,(a?8:-1)*u.height+c.top];e.draggable.current={orig:"a0",origPos:o.key2pos("a0"),piece:t,rel:f,epos:l,pos:[l[0]-f[0],l[1]-f[1]],dec:[-u.width/2,-u.height/2],started:!0,element:()=>d(e,"a0"),originTarget:r.target,newPiece:!0,force:!!i},s(e)},t.move=function(e,t){e.draggable.current&&(!t.touches||t.touches.length<2)&&(e.draggable.current.epos=o.eventPosition(t))},t.end=function(e,t){let r=e.draggable.current;if(!r)return;if("touchend"===t.type&&!1!==t.cancelable&&t.preventDefault(),"touchend"===t.type&&r&&r.originTarget!==t.target&&!r.newPiece){e.draggable.current=void 0;return}n.unsetPremove(e),n.unsetPredrop(e);let i=o.eventPosition(t)||r.epos,l=n.getKeyAtDomPos(i,n.whitePov(e),e.dom.bounds());l&&r.started&&r.orig!==l?r.newPiece?n.dropNewPiece(e,r.orig,l,r.force):(e.stats.ctrlKey=t.ctrlKey,n.userMove(e,r.orig,l)&&(e.stats.dragged=!0)):r.newPiece?delete e.pieces[r.orig]:e.draggable.deleteOnDropOff&&!l&&(delete e.pieces[r.orig],n.callUserFunction(e.events.change)),(r.orig!==r.previouslySelected||r.orig!==l&&l)&&e.selectable.enabled||n.unselect(e),u(e),e.draggable.current=void 0,e.dom.redraw()},t.cancel=c},13378:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(64272),o=r(58775),i=["green","red","blue","yellow"];function l(e){requestAnimationFrame(()=>{let t=e.drawable.current;if(t){let r=n.getKeyAtDomPos(t.pos,n.whitePov(e),e.dom.bounds());r!==t.mouseSq&&(t.mouseSq=r,t.dest=r!==t.orig?r:void 0,e.dom.redrawNow()),l(e)}})}function a(e){e.drawable.current&&(e.drawable.current=void 0,e.dom.redraw())}function s(e){e.onChange&&e.onChange(e.shapes)}t.start=function(e,t){if(t.touches&&t.touches.length>1)return;t.stopPropagation(),t.preventDefault(),t.ctrlKey?n.unselect(e):n.cancelMove(e);let r=o.eventPosition(t),a=n.getKeyAtDomPos(r,n.whitePov(e),e.dom.bounds());a&&(e.drawable.current={orig:a,pos:r,brush:i[((t.shiftKey||t.ctrlKey)&&o.isRightButton(t)?1:0)+(t.altKey||t.metaKey||t.getModifierState("AltGraph")?2:0)]},l(e))},t.processDraw=l,t.move=function(e,t){e.drawable.current&&(e.drawable.current.pos=o.eventPosition(t))},t.end=function(e){let t=e.drawable.current;t&&(t.mouseSq&&function(e,t){let r=e=>e.orig===t.orig&&e.dest===t.dest,n=e.shapes.find(r);n&&(e.shapes=e.shapes.filter(e=>!r(e))),n&&n.brush===t.brush||e.shapes.push(t),s(e)}(e.drawable,t),a(e))},t.cancel=a,t.clear=function(e){e.drawable.shapes.length&&(e.drawable.shapes=[],e.dom.redraw(),s(e.drawable))}},86171:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(64272),o=r(58775),i=r(11445);t.setDropMode=function(e,t){e.dropmode={active:!0,piece:t},i.cancel(e)},t.cancelDropMode=function(e){e.dropmode={active:!1}},t.drop=function(e,t){if(!e.dropmode.active)return;n.unsetPremove(e),n.unsetPredrop(e);let r=e.dropmode.piece;if(r){e.pieces.a0=r;let i=o.eventPosition(t),l=i&&n.getKeyAtDomPos(i,n.whitePov(e),e.dom.bounds());l&&n.dropNewPiece(e,"a0",l)}e.dom.redraw()}},54995:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(11445),o=r(13378),i=r(86171),l=r(58775);function a(e,t,r,n){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r,n)}function s(e,t,r){return n=>{n.shiftKey||l.isRightButton(n)?e.drawable.enabled&&r(e,n):e.viewOnly||t(e,n)}}t.bindBoard=function(e,t){if(e.viewOnly)return;let r=e.dom.elements.board,a=t=>{e.draggable.current?n.cancel(e):e.drawable.current?o.cancel(e):t.shiftKey||l.isRightButton(t)?e.drawable.enabled&&o.start(e,t):e.viewOnly||(e.dropmode.active?i.drop(e,t):n.start(e,t))};r.addEventListener("touchstart",a,{passive:!1}),r.addEventListener("mousedown",a,{passive:!1}),(e.disableContextMenu||e.drawable.enabled)&&r.addEventListener("contextmenu",e=>e.preventDefault()),!e.dom.relative&&e.resizable&&"ResizeObserver"in window&&new window.ResizeObserver(t).observe(r)},t.bindDocument=function(e,t){let r=[];if(e.dom.relative||!e.resizable||"ResizeObserver"in window||r.push(a(document.body,"chessground.resize",t)),!e.viewOnly){let t=s(e,n.move,o.move),i=s(e,n.end,o.end);for(let e of["touchmove","mousemove"])r.push(a(document,e,t));for(let e of["touchend","mouseup"])r.push(a(document,e,i));let l=()=>e.dom.bounds.clear();r.push(a(document,"scroll",l,{capture:!0,passive:!0})),r.push(a(window,"resize",l,{passive:!0}))}return()=>r.forEach(e=>e())}},29572:function(e,t){"use strict";function r(e,t){e.exploding&&(t?e.exploding.stage=t:e.exploding=void 0,e.dom.redraw())}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){e.exploding={stage:1,keys:t},e.dom.redraw(),setTimeout(()=>{r(e,2),setTimeout(()=>r(e,void 0),120)},120)}},87845:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(58775),o=r(38538);t.initial="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR";let i={p:"pawn",r:"rook",n:"knight",b:"bishop",q:"queen",k:"king"},l={pawn:"p",rook:"r",knight:"n",bishop:"b",queen:"q",king:"k"};t.read=function(e){"start"===e&&(e=t.initial);let r={},o=8,l=0;for(let t of e)switch(t){case" ":return r;case"/":if(0==--o)return r;l=0;break;case"~":let e=r[n.pos2key([l,o])];e&&(e.promoted=!0);break;default:let a=t.charCodeAt(0);if(a<57)l+=a-48;else{++l;let e=t.toLowerCase();r[n.pos2key([l,o])]={role:i[e],color:t===e?"black":"white"}}}return r},t.write=function(e){return n.invRanks.map(t=>o.ranks.map(r=>{let o=e[n.pos2key([r,t])];if(!o)return"1";{let e=l[o.role];return"white"===o.color?e.toUpperCase():e}}).join("")).join("/").replace(/1{2,}/g,e=>e.length.toString())}},76347:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(58775);function o(e,t){return Math.abs(e-t)}let i=(e,t,r,n)=>{let i=o(e,r),l=o(t,n);return 1===i&&2===l||2===i&&1===l},l=(e,t,r,n)=>o(e,r)===o(t,n),a=(e,t,r,n)=>e===r||t===n,s=(e,t,r,n)=>l(e,t,r,n)||a(e,t,r,n),c=n.allKeys.map(n.key2pos);t.default=function(e,t,r){var u,p,d;let f=e[t],h=n.key2pos(t),g=f.role,v="pawn"===g?(u=f.color,(e,t,r,n)=>2>o(e,r)&&("white"===u?n===t+1||t<=2&&n===t+2&&e===r:n===t-1||t>=7&&n===t-2&&e===r)):"knight"===g?i:"bishop"===g?l:"rook"===g?a:"queen"===g?s:(p=f.color,d=function(e,t){let r="white"===t?"1":"8";return Object.keys(e).filter(n=>{let o=e[n];return n[1]===r&&o&&o.color===t&&"rook"===o.role}).map(e=>n.key2pos(e)[0])}(e,f.color),(e,t,i,l)=>2>o(e,i)&&2>o(t,l)||r&&t===l&&t===("white"===p?1:8)&&(5===e&&(n.containsX(d,1)&&3===i||n.containsX(d,8)&&7===i)||n.containsX(d,i)));return c.filter(e=>(h[0]!==e[0]||h[1]!==e[1])&&v(h[0],h[1],e[0],e[1])).map(n.pos2key)}},66697:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(58775),o=r(64272),i=r(58775);function l(e){return"PIECE"===e.tagName}function a(e){return"SQUARE"===e.tagName}function s(e,t){for(let r of t)e.dom.elements.board.removeChild(r)}function c(e,t){let r=2+(e[1]-1)*8+(8-e[0]);return t&&(r=67-r),r+""}function u(e){return`${e.color} ${e.role}`}function p(e,t,r){e[t]?e[t]+=" "+r:e[t]=r}t.render=function(e){let t,r,d,f,h,g,v,b,m,y,w;let P=o.whitePov(e),k=e.dom.relative?i.posToTranslateRel:i.posToTranslateAbs(e.dom.bounds()),C=e.dom.relative?i.translateRel:i.translateAbs,_=e.dom.elements.board,E=e.pieces,S=e.animation.current,A=S?S.plan.anims:{},O=S?S.plan.fadings:{},T=e.draggable.current,M=function(e){let t={};if(e.lastMove&&e.highlight.lastMove)for(let r of e.lastMove)p(t,r,"last-move");if(e.check&&e.highlight.check&&p(t,e.check,"check"),e.selected&&(p(t,e.selected,"selected"),e.movable.showDests)){let r=e.movable.dests&&e.movable.dests[e.selected];if(r)for(let n of r)p(t,n,"move-dest"+(e.pieces[n]?" oc":""));let n=e.premovable.dests;if(n)for(let r of n)p(t,r,"premove-dest"+(e.pieces[r]?" oc":""))}let r=e.premovable.current;if(r)for(let e of r)p(t,e,"current-premove");else e.predroppable.current&&p(t,e.predroppable.current.key,"current-premove");let n=e.exploding;if(n)for(let e of n.keys)p(t,e,"exploding"+n.stage);return t}(e),R={},L={},I={},K={},N=Object.keys(E);for(d=_.firstChild;d;){if(t=d.cgKey,l(d)){if(f=E[t],g=A[t],v=O[t],h=d.cgPiece,d.cgDragging&&(!T||T.orig!==t)&&(d.classList.remove("dragging"),C(d,k(n.key2pos(t),P)),d.cgDragging=!1),!v&&d.cgFading&&(d.cgFading=!1,d.classList.remove("fading")),f){if(g&&d.cgAnimating&&h===u(f)){let e=n.key2pos(t);e[0]+=g[2],e[1]+=g[3],d.classList.add("anim"),C(d,k(e,P))}else d.cgAnimating&&(d.cgAnimating=!1,d.classList.remove("anim"),C(d,k(n.key2pos(t),P)),e.addPieceZIndex&&(d.style.zIndex=c(n.key2pos(t),P)));h!==u(f)||v&&d.cgFading?v&&h===u(v)?(d.classList.add("fading"),d.cgFading=!0):I[h]?I[h].push(d):I[h]=[d]:R[t]=!0}else I[h]?I[h].push(d):I[h]=[d]}else if(a(d)){let e=d.className;M[t]===e?L[t]=!0:K[e]?K[e].push(d):K[e]=[d]}d=d.nextSibling}for(let e in M)if(!L[e]){w=(y=K[M[e]])&&y.pop();let t=k(n.key2pos(e),P);if(w)w.cgKey=e,C(w,t);else{let r=n.createEl("square",M[e]);r.cgKey=e,C(r,t),_.insertBefore(r,_.firstChild)}}for(t of N)if(r=E[t],g=A[t],!R[t]){if(m=(b=I[u(r)])&&b.pop()){m.cgKey=t,m.cgFading&&(m.classList.remove("fading"),m.cgFading=!1);let r=n.key2pos(t);e.addPieceZIndex&&(m.style.zIndex=c(r,P)),g&&(m.cgAnimating=!0,m.classList.add("anim"),r[0]+=g[2],r[1]+=g[3]),C(m,k(r,P))}else{let o=u(r),i=n.createEl("piece",o),l=n.key2pos(t);i.cgPiece=o,i.cgKey=t,g&&(i.cgAnimating=!0,l[0]+=g[2],l[1]+=g[3]),C(i,k(l,P)),e.addPieceZIndex&&(i.style.zIndex=c(l,P)),_.appendChild(i)}}for(let t in I)s(e,I[t]);for(let t in K)s(e,K[t])},t.updateBounds=function(e){if(e.dom.relative)return;let t=o.whitePov(e),r=i.posToTranslateAbs(e.dom.bounds()),s=e.dom.elements.board.firstChild;for(;s;)(l(s)&&!s.cgAnimating||a(s))&&i.translateAbs(s,r(n.key2pos(s.cgKey),t)),s=s.nextSibling}},94177:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(87845),o=r(58775);t.defaults=function(){return{pieces:n.read(n.initial),orientation:"white",turnColor:"white",coordinates:!0,autoCastle:!0,viewOnly:!1,disableContextMenu:!1,resizable:!0,addPieceZIndex:!1,pieceKey:!1,highlight:{lastMove:!0,check:!0},animation:{enabled:!0,duration:200},movable:{free:!0,color:"both",showDests:!0,events:{},rookCastle:!0},premovable:{enabled:!0,showDests:!0,castle:!0,events:{}},predroppable:{enabled:!1,events:{}},draggable:{enabled:!0,distance:3,autoDistance:!0,centerPiece:!0,showGhost:!0,deleteOnDropOff:!1},dropmode:{active:!1},selectable:{enabled:!0},stats:{dragged:!("ontouchstart"in window)},events:{},drawable:{enabled:!0,visible:!0,eraseOnClick:!0,shapes:[],autoShapes:[],brushes:{green:{key:"g",color:"#15781B",opacity:1,lineWidth:10},red:{key:"r",color:"#882020",opacity:1,lineWidth:10},blue:{key:"b",color:"#003088",opacity:1,lineWidth:10},yellow:{key:"y",color:"#e68f00",opacity:1,lineWidth:10},paleBlue:{key:"pb",color:"#003088",opacity:.4,lineWidth:15},paleGreen:{key:"pg",color:"#15781B",opacity:.4,lineWidth:15},paleRed:{key:"pr",color:"#882020",opacity:.4,lineWidth:15},paleGrey:{key:"pgr",color:"#4a4a4a",opacity:.35,lineWidth:15}},pieces:{baseUrl:"https://lichess1.org/assets/piece/cburnett/"},prevSvgHash:""},hold:o.timer()}}},53113:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(58775);function o(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function i({orig:e,dest:t,brush:r,piece:n,modifiers:o},i,l,a){return[a.width,a.height,l,e,t,r,t&&i[t]>1,n&&[n.color,n.role,n.scale].filter(e=>e).join(","),o&&""+(o.lineWidth||"")].filter(e=>e).join(",")}function l(e,t){for(let r in t)e.setAttribute(r,t[r]);return e}function a(e,t){return"white"===t?e:[9-e[0],9-e[1]]}function s(e,t){let r={color:e.color,opacity:Math.round(10*e.opacity)/10,lineWidth:Math.round(t.lineWidth||e.lineWidth)};return r.key=[e.key,t.lineWidth].filter(e=>e).join(""),r}function c(e,t){return(e.opacity||1)*(t?.9:1)}function u(e,t){return[(e[0]-.5)*t.width/8,(8.5-e[1])*t.height/8]}t.createElement=o,t.renderSvg=function(e,t){let r=e.drawable,p=r.current,d=p&&p.mouseSq?p:void 0,f={},h=e.dom.bounds();for(let e of r.shapes.concat(r.autoShapes).concat(d?[d]:[]))e.dest&&(f[e.dest]=(f[e.dest]||0)+1);let g=r.shapes.concat(r.autoShapes).map(e=>({shape:e,current:!1,hash:i(e,f,!1,h)}));d&&g.push({shape:d,current:!0,hash:i(d,f,!0,h)});let v=g.map(e=>e.hash).join("");if(v===e.drawable.prevSvgHash)return;e.drawable.prevSvgHash=v;let b=t.firstChild;(function(e,t,r){let n;let i={};for(let r of t)r.shape.dest&&(n=e.brushes[r.shape.brush],r.shape.modifiers&&(n=s(n,r.shape.modifiers)),i[n.key]=n);let a={},c=r.firstChild;for(;c;)a[c.getAttribute("cgKey")]=!0,c=c.nextSibling;for(let e in i)a[e]||r.appendChild(function(e){let t=l(o("marker"),{id:"arrowhead-"+e.key,orient:"auto",markerWidth:4,markerHeight:8,refX:2.05,refY:2.01});return t.appendChild(l(o("path"),{d:"M0,0 V4 L3,2 Z",fill:e.color})),t.setAttribute("cgKey",e.key),t}(i[e]))})(r,g,b),function(e,t,r,i,p,d){let f=e.dom.bounds(),h={},g=[];for(let e of t)h[e.hash]=!1;let v=d.nextSibling,b;for(;v;)b=v.getAttribute("cgHash"),h.hasOwnProperty(b)?h[b]=!0:g.push(v),v=v.nextSibling;for(let e of g)p.removeChild(e);for(let d of t)h[d.hash]||p.appendChild(function(e,{shape:t,current:r,hash:i},p,d,f){let h;if(t.piece)h=function(e,t,r,n){let i=u(t,n),a=n.width/8*(r.scale||1),s=r.color[0]+("knight"===r.role?"n":r.role[0]).toUpperCase();return l(o("image"),{className:`${r.role} ${r.color}`,x:i[0]-a/2,y:i[1]-a/2,width:a,height:a,href:e+s+".svg"})}(e.drawable.pieces.baseUrl,a(n.key2pos(t.orig),e.orientation),t.piece,f);else{let i=a(n.key2pos(t.orig),e.orientation);if(t.dest){let g=p[t.brush];t.modifiers&&(g=s(g,t.modifiers)),h=function(e,t,r,n,i,a){let s=(i&&!n?20:10)/512*a.width,p=u(t,a),d=u(r,a),f=d[0]-p[0],h=Math.atan2(d[1]-p[1],f);return l(o("line"),{stroke:e.color,"stroke-width":(e.lineWidth||10)*(n?.85:1)/512*a.width,"stroke-linecap":"round","marker-end":"url(#arrowhead-"+e.key+")",opacity:c(e,n),x1:p[0],y1:p[1],x2:d[0]-Math.cos(h)*s,y2:d[1]-Math.sin(h)*s})}(g,i,a(n.key2pos(t.dest),e.orientation),r,d[t.dest]>1,f)}else h=function(e,t,r,n){let i=u(t,n),a=function(e){let t=e.width/512;return[3*t,4*t]}(n),s=(n.width+n.height)/32;return l(o("circle"),{stroke:e.color,"stroke-width":a[r?0:1],fill:"none",opacity:c(e,r),cx:i[0],cy:i[1],r:s-a[1]/2})}(p[t.brush],i,r,f)}return h.setAttribute("cgHash",i),h}(e,d,r,i,f))}(e,g,r.brushes,f,t,b)}},38538:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.files=["a","b","c","d","e","f","g","h"],t.ranks=[1,2,3,4,5,6,7,8]},58775:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(38538);t.colors=["white","black"],t.invRanks=[8,7,6,5,4,3,2,1],t.allKeys=Array.prototype.concat(...n.files.map(e=>n.ranks.map(t=>e+t))),t.pos2key=e=>t.allKeys[8*e[0]+e[1]-9],t.key2pos=e=>[e.charCodeAt(0)-96,e.charCodeAt(1)-48],t.memo=function(e){let t;let r=()=>(void 0===t&&(t=e()),t);return r.clear=()=>{t=void 0},r},t.timer=()=>{let e;return{start(){e=performance.now()},cancel(){e=void 0},stop(){if(!e)return 0;let t=performance.now()-e;return e=void 0,t}}},t.opposite=e=>"white"===e?"black":"white",t.containsX=function(e,t){return void 0!==e&&-1!==e.indexOf(t)},t.distanceSq=(e,t)=>Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2),t.samePiece=(e,t)=>e.role===t.role&&e.color===t.color;let o=(e,t,r,n)=>[(t?e[0]-1:8-e[0])*r,(t?8-e[1]:e[1]-1)*n];t.posToTranslateAbs=e=>{let t=e.width/8,r=e.height/8;return(e,n)=>o(e,n,t,r)},t.posToTranslateRel=(e,t)=>o(e,t,100,100),t.translateAbs=(e,t)=>{e.style.transform=`translate(${t[0]}px,${t[1]}px)`},t.translateRel=(e,t)=>{e.style.transform=`translate(${t[0]}%,${t[1]}%)`},t.setVisible=(e,t)=>{e.style.visibility=t?"visible":"hidden"},t.eventPosition=e=>e.clientX||0===e.clientX?[e.clientX,e.clientY]:e.touches&&e.targetTouches[0]?[e.targetTouches[0].clientX,e.targetTouches[0].clientY]:void 0,t.isRightButton=e=>2===e.buttons||2===e.button,t.createEl=(e,t)=>{let r=document.createElement(e);return t&&(r.className=t),r}},43949:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(58775),o=r(38538),i=r(53113);function l(e,t){let r;let o=n.createEl("coords",t);for(let t of e)(r=n.createEl("coord")).textContent=t,o.appendChild(r);return o}t.default=function(e,t,r){let a,s;for(let r of(e.innerHTML="",e.classList.add("cg-wrap"),n.colors))e.classList.toggle("orientation-"+r,t.orientation===r);e.classList.toggle("manipulable",!t.viewOnly);let c=n.createEl("cg-helper");e.appendChild(c);let u=n.createEl("cg-container");c.appendChild(u);let p=n.createEl("cg-board");if(u.appendChild(p),t.drawable.visible&&!r&&((a=i.createElement("svg")).appendChild(i.createElement("defs")),u.appendChild(a)),t.coordinates){let e="black"===t.orientation?" black":"";u.appendChild(l(o.ranks.map(e=>e.toString()),"ranks"+e)),u.appendChild(l(o.files,"files"+e))}return t.draggable.showGhost&&!r&&(s=n.createEl("piece","ghost"),n.setVisible(s,!1),u.appendChild(s)),{board:p,container:u,ghost:s,svg:a}}},99949:function(e,t,r){"use strict";var n=r(88877);function o(){}function i(){}i.resetWarningCache=o,e.exports=function(){function e(e,t,r,o,i,l){if(l!==n){var a=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function t(){return e}e.isRequired=e;var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:o};return r.PropTypes=r,r}},41448:function(e,t,r){e.exports=r(99949)()},88877:function(e){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},75166:function(e,t,r){"use strict";r.d(t,{default:function(){return c}});var n=r(2265),o=r(41448),i=r.n(o),l=r(27304);function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var c=function(e){function t(){return e.apply(this,arguments)||this}t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e;var r=t.prototype;return r.buildConfigFromProps=function(e){var r={events:{}};return Object.keys(t.propTypes).forEach(function(t){var n=e[t];if(void 0!==n){var o=t.match(/^on([A-Z]\S*)/);o?r.events[o[1].toLowerCase()]=n:r[t]=n}}),r},r.componentDidMount=function(){this.cg=(0,l.H)(this.el,this.buildConfigFromProps(this.props))},r.componentWillReceiveProps=function(e){this.cg.set(this.buildConfigFromProps(e))},r.componentWillUnmount=function(){this.cg.destroy()},r.render=function(){var e=this,t={style:a({},this.props.style)};return this.props.width&&(t.style.width=this.props.width),this.props.height&&(t.style.height=this.props.height),n.createElement("div",a({ref:function(t){return e.el=t}},t))},t}(n.Component);s(c,"propTypes",{width:i().oneOfType([i().string,i().number]),height:i().oneOfType([i().string,i().number]),fen:i().string,orientation:i().string,turnColor:i().string,check:i().string,lastMove:i().array,selected:i().string,coordinates:i().bool,autoCastle:i().bool,viewOnly:i().bool,disableContextMenu:i().bool,resizable:i().bool,addPieceZIndex:i().bool,highlight:i().object,animation:i().object,movable:i().object,premovable:i().object,predroppable:i().object,draggable:i().object,selectable:i().object,onChange:i().func,onMove:i().func,onDropNewPiece:i().func,onSelect:i().func,items:i().object,drawable:i().object}),s(c,"defaultProps",{coordinates:!0,resizable:!0,highlight:{lastMove:!0,check:!0}})},23160:function(e,t,r){e.exports=r(75166)},82234:function(){}}]);