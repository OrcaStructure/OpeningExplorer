(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{81961:function(e,t,r){Promise.resolve().then(r.bind(r,94430))},94430:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return k}});var n,s=r(57437),o=r(2265),a=r(24012),c=r(99763),l=r(73654),i=r(57029),u=r(87520),h=r(62238),d=r(96293),p=r(27889),f=r.n(p),g=r(23160);r(82234),r(30047),r(89097),r(50871);var m=e=>{let t={};return e.SQUARES.forEach(r=>{let n=e.moves({square:r,verbose:!0});n.length&&(t[r]=n.map(e=>e.to))}),{color:"w"===e.turn()?"white":"black",dests:t,free:!1}};n=new Worker("stockfish.js");var w=0;function v(e){let{onReset:t,onFlip:r,onToggleMode:a,onGetPgn:c,setEvaluation:l}=e,[i,u]=(0,o.useState)("rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1"),[h,d]=(0,o.useState)("white"),[p,v]=(0,o.useState)(!1),x=(0,o.useRef)(new(f())(i)),_=()=>{let e=x.current.pgn();return console.log("Generated PGN:",e),e};var k="w"===x.current.turn()?"white":"black";let b=(0,o.useRef)(null),[j,C]=(0,o.useState)(512);(0,o.useEffect)(()=>{let e=()=>{b.current&&C(Math.min(b.current.offsetWidth,512))};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),n.onmessage=e=>{if((e=e.data)&&"string"==typeof e&&e.includes("info depth 16")){console.log(e,"data");let t=e.match(/score cp (-?\d+)/);t&&(w=-1*("w"==x.current.turn()?1:-1)*parseInt(t[1],10)/100)}};let M=(e,t)=>{x.current.move({from:e,to:t}),console.log("Moved:",x.current.pgn()),u(x.current.fen()),l(N(x.current)),k="w"===x.current.turn()?"white":"black",1==p&&P(),n.postMessage("go depth 20"),n.postMessage("position fen "+x.current.fen())},N=e=>w,P=()=>{console.log(h,k),h!==k&&(console.log("yes"),R())},y=e=>{throw Error("Network response was not ok "+e.statusText)},G=e=>{var t=[],r=[];if(e.white+e.black+e.draws<5){console.log("No more games");return}for(var n=0;n<e.moves.length;n++)if(t.push((e.moves[n].white+e.moves[n].black+e.moves[n].draws)/(e.white+e.black+e.draws)),r.push(e.moves[n].uci),"O-O"===e.moves[n].san||"O-O-O"===e.moves[n].san)switch(r[n]){case"e1h1":r[n]="e1g1";break;case"e1a1":r[n]="e1c1";break;case"e8a8":r[n]="e8c8";break;case"e8h8":r[n]="e8g8"}return[r,t]},E=e=>({from:e.slice(0,2),to:e.slice(2,4),promotion:"q"}),R=()=>{fetch("https://explorer.lichess.ovh/lichess?variant=standard&speeds=blitz,rapid,classical&ratings=1800,2000,2200,2500&fen=".concat(x.current.fen().replaceAll(" ","%20"),"&topGames=0&recentGames=0")).then(e=>(e.ok||y(e),e.json())).then(e=>{let[t,r]=G(e),n=E(function(e,t){for(let e=1;e<t.length;e++)t[e]+=t[e-1];let r=Math.random()*t[t.length-1];for(let n=0;n<t.length;n++)if(t[n]>r)return e[n]}(t,r));M(n.from,n.to)}).catch(e=>{console.error("There was a problem with the fetch operation: ",e)})},S=()=>{x.current.reset(),u(x.current.fen())},B=()=>{d(e=>"white"===e?"black":"white")},O=()=>{v(e=>!e),p||(k="w"===x.current.turn()?"white":"black",P())};return(0,o.useEffect)(()=>{let e=setInterval(()=>{l(N(x.current))},200);return t&&t(S),r&&r(B),a&&a(O),c&&c(_),()=>clearInterval(e)},[t,r,a,c,l]),(0,s.jsxs)("div",{className:"chessboard-container",ref:b,style:{width:"100%",maxWidth:"512px",margin:"20px auto",padding:"10px",backgroundColor:"#f9f9f9",borderRadius:"8px"},children:[(0,s.jsx)(g.default,{fen:i,turnColor:k,onMove:M,movable:m(x.current),orientation:h,width:j,height:j}),(0,s.jsxs)("p",{children:["Current Mode: ",p?"Vs Database":"Edit Position"]})]})}n.postMessage("uci"),n.postMessage("ucinewgame");var x=r(59671),_=r.n(x),k=()=>{let[e,t]=(0,o.useState)(!1),[r,n]=(0,o.useState)(""),[p,f]=(0,o.useState)(0),g=(0,o.useRef)(null),m=(0,o.useRef)(null),w=(0,o.useRef)(null),x=(0,o.useRef)(null);return(0,s.jsxs)("div",{className:_().container,children:[(0,s.jsxs)("header",{className:_().header,children:[(0,s.jsx)("h1",{children:"Interactive Chess Game"}),(0,s.jsx)("p",{children:"Play and explore chess moves in real-time"})]}),(0,s.jsx)(a.Card,{shadow:"sm",padding:"lg",style:{textAlign:"center",marginBottom:"20px"},children:(0,s.jsxs)(c.Title,{order:4,children:["Current Evaluation: ",p>0?"+".concat(p):p]})}),(0,s.jsx)(v,{onReset:e=>g.current=e,onFlip:e=>m.current=e,onToggleMode:e=>w.current=e,onGetPgn:e=>x.current=e,setEvaluation:f}),(0,s.jsxs)(l.Grid,{gutter:"sm",justify:"center",children:[(0,s.jsx)(l.Grid.Col,{span:6,xs:12,sm:4,children:(0,s.jsx)(i.Button,{fullWidth:!0,onClick:()=>{g.current&&g.current()},children:"Reset Game"})}),(0,s.jsx)(l.Grid.Col,{span:6,xs:12,sm:4,children:(0,s.jsx)(i.Button,{fullWidth:!0,onClick:()=>{m.current&&m.current()},children:"Flip Board"})}),(0,s.jsx)(l.Grid.Col,{span:6,xs:12,sm:4,children:(0,s.jsx)(i.Button,{fullWidth:!0,onClick:()=>{w.current&&w.current()},children:"Toggle Mode"})})]}),(0,s.jsx)(u.Modal,{opened:e,onClose:()=>t(!1),title:"Chess Analysis",size:"lg",children:(0,s.jsx)("iframe",{src:"https://lichess.org/analysis/pgn/".concat(encodeURIComponent(r)),width:"100%",height:"400",title:"Chess Analysis"})}),(0,s.jsx)(i.Button,{onClick:()=>{x.current?(n(x.current()),t(!0)):console.error("PGN function not initialized yet.")},mt:"md",children:"Open Popup with Iframe"}),(0,s.jsx)(h.ScrollArea,{style:{width:"100%",whiteSpace:"nowrap"},mt:"lg",children:(0,s.jsx)(d.Text,{className:_().moves,children:"Move 1: e2-e4 | Move 2: e7-e5 | Move 3: Nf3 Nc6 | Move 4: Bb5 a6"})})]})}},30047:function(){},89097:function(){},50871:function(){},59671:function(e){e.exports={page:"page_page__ZU32B",main:"page_main__GlU4n",ctas:"page_ctas__g5wGe",primary:"page_primary__V8M9Y",secondary:"page_secondary__lm_PT",footer:"page_footer__sHKi3",logo:"page_logo__7fc9l",container:"page_container__aoG4z",header:"page_header__kVzhN",moves:"page_moves__4woCm"}}},function(e){e.O(0,[432,463,427,971,23,744],function(){return e(e.s=81961)}),_N_E=e.O()}]);